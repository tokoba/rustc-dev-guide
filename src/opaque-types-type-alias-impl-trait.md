# 不透明型（型エイリアス `impl Trait`）

不透明型は、インターフェースとして特定のトレイトセットのみを公開する
不透明な型エイリアスを宣言する構文です。背後にある具体的な型は、
不透明型の特定の使用サイトのセットから推論されます。

これは型エイリアス内で`impl Trait`を使用することで表現されます。例えば：

```rust,ignore
type Foo = impl Bar;
```

これは`Foo`という名前の不透明型を宣言し、その唯一の情報は
`Bar`を実装していることです。したがって、`Bar`のインターフェースは`Foo`に対して使用できますが、
それ以外は使用できません（他のトレイトを実装しているかどうかに関わらず）。

具体的な背後の型が必要なため、
（<!-- date-check --> 2021年1月現在）「定義使用サイト」で
その型を表現できます。

```rust,ignore
struct Struct;
impl Bar for Struct { /* stuff */ }
fn foo() -> Foo {
    Struct
}
```

他の「定義使用サイト」は、全く同じ型を生成する必要があります。

## 定義使用サイト

現在、関数の戻り値のみが不透明型の定義使用サイトになることができます
（そして、その関数の戻り型が不透明型を含む場合のみ）。

不透明型の定義使用は、不透明型定義の親内の任意のコードになることができます。
これには、不透明型の任意の兄弟と、
兄弟のすべての子が含まれます。

*「開発者の脳が型システムが何をしているのかを理解しようとして
偶発的に無限ループを実行することによる致命的な脳損傷を引き起こさない」*
という取り組みは、不透明型の子が定義使用サイトになることを禁止することを決定しました。

### 関連不透明型

関連不透明型は、同じトレイト`impl`の他の関連アイテムまたは
これらの関連アイテムの子によって定義できます。例えば：

```rust,ignore
trait Baz {
    type Foo;
    fn foo() -> Self::Foo;
}

struct Quux;

impl Baz for Quux {
    type Foo = impl Bar;
    fn foo() -> Self::Foo { ... }
}
```
